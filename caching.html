

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>caching &mdash; Monty Lacuna 0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="static/monty_foot.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Monty Lacuna 0.1 documentation" href="index.html"/>
        <link rel="up" title="Other Modules" href="other_modules.html"/>
        <link rel="next" title="clients" href="clients.html"/>
        <link rel="prev" title="bc" href="bc.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> Monty Lacuna</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started_running.html">Getting Started Running Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#overview-of-steps">Overview of Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-python-3">Install Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-montylacuna">Install MontyLacuna</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-pip-and-prerequisite-libraries">Install pip and Prerequisite Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#create-a-config-file">Create A Config File</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#ready-to-test">Ready to Test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts/index.html">MontyLacuna Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scripts/index.html#starter-scripts">Starter Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts/index.html#regular-scripts">Regular Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts/abbreviations.html">Body Abbreviations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scripts/abbreviations.html#setting-abbreviations">Setting Abbreviations</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts/abbreviations.html#displaying-set-abbreviations">Displaying Set Abbreviations</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts/abbreviations.html#deleting-an-abbreviation">Deleting An Abbreviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts/abbreviations.html#using-abbreviations">Using Abbreviations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Config File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#setting-descriptions">Setting Descriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#default-values">Default Values</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_writing.html">Getting Started Writing Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#tell-your-script-where-montylacuna-lives">Tell Your Script Where MontyLacuna Lives</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#connect-a-client">Connect a client</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#logging-and-caching">Logging and Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#debugging-requests">Debugging Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#method-calling">Method Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#test-scripts">Test Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#adding-unit-tests">Adding Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#example-snippets">Example Snippets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tle_modules/index.html">TLE Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/alliance.html">Alliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/body.html">Body</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/building.html">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/captcha.html">Captcha</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/inbox.html">Inbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/map.html">Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="tle_modules/stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tests/index.html">Unit Tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tests/index.html#existing-tests">Existing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="tests/index.html#running-all-tests">Running all tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="tests/index.html#creating-script-tests">Creating script tests</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="other_modules.html">Other Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="abbreviations.html">Abbreviations</a></li>
<li class="toctree-l2"><a class="reference internal" href="bc.html">bc</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="clients.html">clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="glyph.html">glyph</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="my_validate_email.html">my_validate_email</a></li>
<li class="toctree-l2"><a class="reference internal" href="plan.html">plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="recycling.html">recycling</a></li>
<li class="toctree-l2"><a class="reference internal" href="resource.html">resource</a></li>
<li class="toctree-l2"><a class="reference internal" href="ship.html">ship</a></li>
<li class="toctree-l2"><a class="reference internal" href="spy.html">spy</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading.html">trading</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">types</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Monty Lacuna</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="other_modules.html">Other Modules</a> &raquo;</li>
      
    <li>caching</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="sources/caching.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="caching">
<span id="id1"></span><h1>caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Almost every MontyLacuna method call represents a communication with the TLE
server.  This communication takes time, and an additional second is used by
MontyLacuna, per call, to make sure that we don&#8217;t swamp the server with too
many requests, which would result in a mandatory one minute lockout.</p>
<p>Often, your code will need to re-access the same information more than once,
or even access information that you&#8217;ve recently accessed in an entirely
different script.  In these cases, you can make use of the client.Member
class&#8217;s built-in caching facility.</p>
</div>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre>import lacuna

my_client = lacuna.clients.Member( connection args )

### Caching is not turned on by default.

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Turn caching on

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds

my_planet_one = my_client.get_body_byname(&quot;Mars&quot;)     # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Mars&quot;)     # takes 4 or 5 milliseconds

my_client.cache_on( &#39;my_buildings&#39;, 3600 )            # Switch to a different cache namespace
sps = planet.get_buildings_bytype( &#39;spaceport&#39; )      # Get all spaceports on the planet
...time passes...
sps = planet.get_buildings_bytype( &#39;spaceport&#39; )      # Get spaceports again, much faster

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Switch back to the my_planets namespace
my_client.cache_clear( &#39;my_planets&#39; )                 # clear this cache, but don&#39;t turn it off

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds

my_client.cache_off()                                 # Turn caching off, but don&#39;t clear entries

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Turn caching back on

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>When you turn caching on, you pass in a name and an expiration time.  While
caching is on, every request to the server will be curried, so when two
identical requests are made, the second returns the same data that was returned
by the first, without having to re-query the server.  You can have multiple
caches, switching between them by simply calling cache_on() with the name of the
cache you want to use.</p>
<p>It&#8217;s important to understand that the name you&#8217;re passing to <code class="docutils literal"><span class="pre">cache_on()</span></code> is a
namespace name, not a specific cache key.  Individual cache keys will be
generated for you, and are invisible to you.  So a single cache name can safely
contain multiple different types of data.  The cache keys are determined by both
the server method you&#8217;re calling and the parameters you&#8217;re passing to that
method.</p>
<dl class="docutils">
<dt>Certain actions you take will invalidate your cached data.  In this scenario:</dt>
<dd><ul class="first last simple">
<li>Turn caching on</li>
<li>Get list of buildings on the surface of a planet</li>
<li>Build a new building on that planet</li>
<li>Get list of buildings on the surface of that same planet<ul>
<li>GONNNGG!  Since caching is turned on, we&#8217;ll get the same list we had
before, which does not include our new building.</li>
</ul>
</li>
</ul>
</dd>
</dl>
<p>In that case, you&#8217;d want to clear out the cache after constructing your new
building; this would cause the next &#8220;get list of buildings&#8221; to actually hit the
server again, and the retrieved list would now contain your new building.</p>
<p>You&#8217;re encouraged to use multiple named caches in your code.  This way, you can
clear out any cache namespace that becomes invalid because of some other action,
while maintaining the cached data in your other namespaces.</p>
<p>Cached data is saved to local files, so accessing the same named cache between
different runs of a script, or even between two entirely different scripts, will
make use of your caches.</p>
</div>
<div class="section" id="script-conventions">
<h2>Script Conventions<a class="headerlink" href="#script-conventions" title="Permalink to this headline">¶</a></h2>
<p>The scripts that come packaged with MontyLacuna often have to perform many of
the same tasks, such as listing out all of your planets.  Those scripts
generally use a cache named <code class="docutils literal"><span class="pre">my_colonies</span></code> for this planet-listing work.
This means that, after you run one script to get colony data, running any
other script using that cache will be faster, as the colony data is already
cached.</p>
<p>If you run a MontyLacuna script, then go colonize a new planet, your new
planet won&#8217;t appear in the pre-cached planet list.  In this case, you should
just delete the contents of the <code class="docutils literal"><span class="pre">var/cache/</span></code> directory before running
another script.</p>
</div>
<div class="section" id="module-lacuna.clients">
<span id="module-documentation"></span><h2>Module Documentation<a class="headerlink" href="#module-lacuna.clients" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt>
<code class="descclassname">Member.</code><code class="descname">cache_on</code><span class="sig-paren">(</span><em>name: str</em>, <em>expiry: int=3600</em><span class="sig-paren">)</span></dt>
<dd><p>Turn the cache on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) &#8211; namespace to use for caching data</li>
<li><strong>expiry</strong> (<em>int</em>) &#8211; seconds after which cached data is no longer
valid.  Defaults to 3600 (one hour).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">namespace that had previously been set.  Empty
string if no cache had previously been on.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descclassname">Member.</code><code class="descname">cache_off</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn caching off.
Does not clear any existing caches, only stops pulling data from them.
Returns the name of the cache that had been in use, or False if none.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descclassname">Member.</code><code class="descname">cache_clear</code><span class="sig-paren">(</span><em>name: str=''</em><span class="sig-paren">)</span></dt>
<dd><p>Clears a named cache.  If a cache name is not passed, clears the most-recently used cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; name of the cache to clear.  Defaults to the
cache most recently used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if a cache was cleared, false if no name was passed in and
no cache has yet been used by this client (so there&#8217;s no
&#8220;most-recently-used&#8221; cache name to clear).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="clients.html" class="btn btn-neutral float-right" title="clients">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bc.html" class="btn btn-neutral" title="bc"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014 - 2015, Jonathan Barton.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>