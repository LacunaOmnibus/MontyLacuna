

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Caching &mdash; Monty Lacuna 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Monty Lacuna 0.1 documentation" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Monty Lacuna</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started_running.html">Getting Started Running Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-python-3">Install Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-montylacuna">Install MontyLacuna</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#install-pip-and-prerequisite-libraries">Install pip and Prerequisite Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#create-a-config-file">Create A Config File</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_running.html#ready-to-run-scripts">Ready to Run Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts/index.html">MontyLacuna Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scripts/index.html#starter-scripts">Starter Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts/index.html#regular-scripts">Regular Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Config File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#setting-descriptions">Setting Descriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#default-values">Default Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#section-variable-interpolation">Section Variable Interpolation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_writing.html">Getting Started Writing Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#test-scripts">Test Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#tell-your-script-where-montylacuna-lives">Tell Your Script Where MontyLacuna Lives</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#connect-a-client">Connect a client</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#logging-and-caching">Logging and Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#debugging-requests">Debugging Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_writing.html#example-snippets">Example Snippets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tlemodules/index.html">TLE Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/alliance.html">Alliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/body.html">Body</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/building.html">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/captcha.html">Captcha</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/inbox.html">Inbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/map.html">Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="tlemodules/stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bc.html">bc</a></li>
<li class="toctree-l1"><a class="reference internal" href="clients.html">clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glyph.html">glyph</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_validate_email.html">my_validate_email</a></li>
<li class="toctree-l1"><a class="reference internal" href="plan.html">plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="recycling.html">recycling</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="ship.html">ship</a></li>
<li class="toctree-l1"><a class="reference internal" href="spy.html">spy</a></li>
<li class="toctree-l1"><a class="reference internal" href="trading.html">trading</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Monty Lacuna</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Caching</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="sources/caching.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="caching">
<span id="id1"></span><h1>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Almost every MontyLacuna method call represents a communication with the TLE
server.  This communication takes time, and an additional second is used by
MontyLacuna, per call, to make sure that we don&#8217;t swamp the server with too
many requests, which would result in a mandatory one minute lockout.</p>
<p>Often, your code will need to re-access the same information more than once,
or even access information that you&#8217;ve recently accessed in an entirely
different script.  In these cases, you can make use of the client.Member
class&#8217;s built-in caching facility.</p>
</div>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre>import lacuna

my_client = lacuna.clients.Member( connection args )

### Caching is not turned on by default.

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Turn caching on

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds

my_planet_one = my_client.get_body_byname(&quot;Mars&quot;)     # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Mars&quot;)     # takes 4 or 5 milliseconds

my_client.cache_on( &#39;my_buildings&#39;, 3600 )            # Switch to a different cache namespace
sps = planet.get_buildings_bytype( &#39;spaceport&#39; )      # Get all spaceports on the planet
...time passes...
sps = planet.get_buildings_bytype( &#39;spaceport&#39; )      # Get spaceports again, much faster

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Switch back to the my_planets namespace
my_client.cache_clear( &#39;my_planets&#39; )                 # clear this cache, but don&#39;t turn it off

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds, but result was cached
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds

my_client.cache_off()                                 # Turn caching off, but don&#39;t clear entries

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds
my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 1-3 seconds

my_client.cache_on( &#39;my_planets&#39;, 3600 )              # Turn caching back on

my_planet_one = my_client.get_body_byname(&quot;Earth&quot;)    # takes 4 or 5 milliseconds
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>When you turn caching on, you pass in a name and an expiration time.  While
caching is on, every request to the server will be curried, so when two
identical requests are made, the second returns the same data that was returned
by the first, without having to re-query the server.  You can have multiple
caches, switching between them by simply calling cache_on() with the name of the
cache you want to use.</p>
<p>It&#8217;s important to understand that the name you&#8217;re passing to <tt class="docutils literal"><span class="pre">cache_on()</span></tt> is a
namespace name, not a specific cache key.  Individual cache keys will be
generated for you, and are invisible to you.  So a single cache name can safely
contain multiple different types of data.  The cache keys are determined by both
the server method you&#8217;re calling and the parameters you&#8217;re passing to that
method.</p>
<dl class="docutils">
<dt>Certain actions you take will invalidate your cached data.  In this scenario:</dt>
<dd><ul class="first last simple">
<li>Turn caching on</li>
<li>Get list of buildings on the surface of a planet</li>
<li>Build a new building on that planet</li>
<li>Get list of buildings on the surface of that same planet<ul>
<li>GONNNGG!  Since caching is turned on, we&#8217;ll get the same list we had
before, which does not include our new building.</li>
</ul>
</li>
</ul>
</dd>
</dl>
<p>In that case, you&#8217;d want to clear out the cache after constructing your new
building; this would cause the next &#8220;get list of buildings&#8221; to actually hit the
server again, and the retrieved list would now contain your new building.</p>
<p>You&#8217;re encouraged to use multiple named caches in your code.  This way, you can
clear out any cache namespace that becomes invalid because of some other action,
while maintaining the cached data in your other namespaces.</p>
<p>Cached data is saved to local files, so accessing the same named cache between
different runs of a script, or even between two entirely different scripts, will
make use of your caches.</p>
<span class="target" id="module-lacuna.clients"></span><dl class="method">
<dt>
<tt class="descclassname">Member.</tt><tt class="descname">cache_on</tt><big>(</big><em>name: str</em>, <em>expiry: int=3600</em><big>)</big></dt>
<dd><p>Turn the cache on.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><ul class="first last simple">
<li>name &#8211; String namespace to use for caching data</li>
<li>expiry &#8211; Integer seconds after which cached data is no longer 
valid.  Defaults to 3600 (one hour).</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<tt class="descclassname">Member.</tt><tt class="descname">cache_off</tt><big>(</big><big>)</big></dt>
<dd><p>Turn caching off.
Does not clear any existing caches, only stops pulling data from them.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descclassname">Member.</tt><tt class="descname">cache_clear</tt><big>(</big><em>name: str=''</em><big>)</big></dt>
<dd><p>Clears a named cache.  If a cache name is not passed, clears the most-recently used cache.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><ul class="first last simple">
<li>name &#8211; String; name of the cache to clear.  Defaults to the 
cache most recently used.</li>
</ul>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="n">client</span><span class="o">.</span><span class="n">cache_on</span><span class="p">(</span><span class="s">&#39;cache_one&#39;</span> <span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">cache_on</span><span class="p">(</span><span class="s">&#39;cache_two&#39;</span> <span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>                <span class="c"># clear cache_two implicitly</span>
<span class="n">client</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">(</span> <span class="s">&#39;cache_one&#39;</span> <span class="p">)</span>   <span class="c"># clear cache_one explicitly</span>
</pre></div>
</div>
<p>Returns True if a cache was cleared, false if no name was passed in and 
no cache has yet been used by this client (so there&#8217;s no 
&#8220;most-recently-used&#8221; cache name to clear).</p>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Jonathan Barton.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>